var QRCode;
!function() {
  function QR8bitByte(data) {
    this.mode = QRMode.MODE_8BIT_BYTE;
    this.data = data;
    this.parsedData = [];
    var res = [];
    var i = 0;
    var l = this.data.length;
    for (;l > i;i++) {
      var key = this.data.charCodeAt(i);
      if (key > 65536) {
        res[0] = 240 | (1835008 & key) >>> 18;
        res[1] = 128 | (258048 & key) >>> 12;
        res[2] = 128 | (4032 & key) >>> 6;
        res[3] = 128 | 63 & key;
      } else {
        if (key > 2048) {
          res[0] = 224 | (61440 & key) >>> 12;
          res[1] = 128 | (4032 & key) >>> 6;
          res[2] = 128 | 63 & key;
        } else {
          if (key > 128) {
            res[0] = 192 | (1984 & key) >>> 6;
            res[1] = 128 | 63 & key;
          } else {
            res[0] = key;
          }
        }
      }
      this.parsedData = this.parsedData.concat(res);
    }
    if (this.parsedData.length != this.data.length) {
      this.parsedData.unshift(191);
      this.parsedData.unshift(187);
      this.parsedData.unshift(239);
    }
  }
  function QRCodeModel(typeNumber, errorCorrectLevel) {
    this.typeNumber = typeNumber;
    this.errorCorrectLevel = errorCorrectLevel;
    this.modules = null;
    this.moduleCount = 0;
    this.dataCache = null;
    this.dataList = [];
  }
  function QRPolynomial(num, shift) {
    if (void 0 == num.length) {
      throw new Error(num.length + "/" + shift);
    }
    var offset = 0;
    for (;offset < num.length && 0 == num[offset];) {
      offset++;
    }
    this.num = new Array(num.length - offset + shift);
    var i = 0;
    for (;i < num.length - offset;i++) {
      this.num[i] = num[i + offset];
    }
  }
  function QRRSBlock(totalCount, dataCount) {
    this.totalCount = totalCount;
    this.dataCount = dataCount;
  }
  function QRBitBuffer() {
    this.buffer = [];
    this.length = 0;
  }
  function hasOwnProp() {
    return "undefined" != typeof CanvasRenderingContext2D;
  }
  function _getAndroid() {
    var q = false;
    var sAgent = navigator.userAgent;
    return/android/i.test(sAgent) && (q = true, aMat = sAgent.toString().match(/android ([0-9]\.[0-9])/i), aMat && (aMat[1] && (q = parseFloat(aMat[1])))), q;
  }
  function _getTypeNumber(sText, nCorrectLevel) {
    var nType = 1;
    var length = _getUTF8Length(sText);
    var i = 0;
    var cnl = codeSegments.length;
    for (;cnl >= i;i++) {
      var high = 0;
      switch(nCorrectLevel) {
        case QRErrorCorrectLevel.L:
          high = codeSegments[i][0];
          break;
        case QRErrorCorrectLevel.M:
          high = codeSegments[i][1];
          break;
        case QRErrorCorrectLevel.Q:
          high = codeSegments[i][2];
          break;
        case QRErrorCorrectLevel.H:
          high = codeSegments[i][3];
      }
      if (high >= length) {
        break;
      }
      nType++;
    }
    if (nType > codeSegments.length) {
      throw new Error("Too long data");
    }
    return nType;
  }
  function _getUTF8Length(sText) {
    var replacedText = encodeURI(sText).toString().replace(/\%[0-9a-fA-F]{2}/g, "a");
    return replacedText.length + (replacedText.length != sText ? 3 : 0);
  }
  QR8bitByte.prototype = {
    getLength : function() {
      return this.parsedData.length;
    },
    write : function(buffer) {
      var i = 0;
      var l = this.parsedData.length;
      for (;l > i;i++) {
        buffer.put(this.parsedData[i], 8);
      }
    }
  };
  QRCodeModel.prototype = {
    addData : function(data) {
      var newData = new QR8bitByte(data);
      this.dataList.push(newData);
      this.dataCache = null;
    },
    isDark : function(row, col) {
      if (0 > row || (this.moduleCount <= row || (0 > col || this.moduleCount <= col))) {
        throw new Error(row + "," + col);
      }
      return this.modules[row][col];
    },
    getModuleCount : function() {
      return this.moduleCount;
    },
    make : function() {
      this.makeImpl(false, this.getBestMaskPattern());
    },
    makeImpl : function(test, maskPattern) {
      this.moduleCount = 4 * this.typeNumber + 17;
      this.modules = new Array(this.moduleCount);
      var row = 0;
      for (;row < this.moduleCount;row++) {
        this.modules[row] = new Array(this.moduleCount);
        var col = 0;
        for (;col < this.moduleCount;col++) {
          this.modules[row][col] = null;
        }
      }
      this.setupPositionProbePattern(0, 0);
      this.setupPositionProbePattern(this.moduleCount - 7, 0);
      this.setupPositionProbePattern(0, this.moduleCount - 7);
      this.setupPositionAdjustPattern();
      this.setupTimingPattern();
      this.setupTypeInfo(test, maskPattern);
      if (this.typeNumber >= 7) {
        this.setupTypeNumber(test);
      }
      if (null == this.dataCache) {
        this.dataCache = QRCodeModel.createData(this.typeNumber, this.errorCorrectLevel, this.dataList);
      }
      this.mapData(this.dataCache, maskPattern);
    },
    setupPositionProbePattern : function(row, col) {
      var r = -1;
      for (;7 >= r;r++) {
        if (!(-1 >= row + r || this.moduleCount <= row + r)) {
          var c = -1;
          for (;7 >= c;c++) {
            if (!(-1 >= col + c)) {
              if (!(this.moduleCount <= col + c)) {
                this.modules[row + r][col + c] = r >= 0 && (6 >= r && (0 == c || 6 == c)) || (c >= 0 && (6 >= c && (0 == r || 6 == r)) || r >= 2 && (4 >= r && (c >= 2 && 4 >= c))) ? true : false;
              }
            }
          }
        }
      }
    },
    getBestMaskPattern : function() {
      var delay = 0;
      var pattern = 0;
      var i = 0;
      for (;8 > i;i++) {
        this.makeImpl(true, i);
        var maxDelay = QRUtil.getLostPoint(this);
        if (0 == i || delay > maxDelay) {
          delay = maxDelay;
          pattern = i;
        }
      }
      return pattern;
    },
    createMovieClip : function(target_mc, instance_name, depth) {
      var qr_mc = target_mc.createEmptyMovieClip(instance_name, depth);
      var cs = 1;
      this.make();
      var row = 0;
      for (;row < this.modules.length;row++) {
        var y = row * cs;
        var col = 0;
        for (;col < this.modules[row].length;col++) {
          var x = col * cs;
          var dark = this.modules[row][col];
          if (dark) {
            qr_mc.beginFill(0, 100);
            qr_mc.moveTo(x, y);
            qr_mc.lineTo(x + cs, y);
            qr_mc.lineTo(x + cs, y + cs);
            qr_mc.lineTo(x, y + cs);
            qr_mc.endFill();
          }
        }
      }
      return qr_mc;
    },
    setupTimingPattern : function() {
      var r = 8;
      for (;r < this.moduleCount - 8;r++) {
        if (null == this.modules[r][6]) {
          this.modules[r][6] = 0 == r % 2;
        }
      }
      var c = 8;
      for (;c < this.moduleCount - 8;c++) {
        if (null == this.modules[6][c]) {
          this.modules[6][c] = 0 == c % 2;
        }
      }
    },
    setupPositionAdjustPattern : function() {
      var pos = QRUtil.getPatternPosition(this.typeNumber);
      var j = 0;
      for (;j < pos.length;j++) {
        var i = 0;
        for (;i < pos.length;i++) {
          var row = pos[j];
          var col = pos[i];
          if (null == this.modules[row][col]) {
            var r = -2;
            for (;2 >= r;r++) {
              var c = -2;
              for (;2 >= c;c++) {
                this.modules[row + r][col + c] = -2 == r || (2 == r || (-2 == c || (2 == c || 0 == r && 0 == c))) ? true : false;
              }
            }
          }
        }
      }
    },
    setupTypeNumber : function(test) {
      var bits = QRUtil.getBCHTypeNumber(this.typeNumber);
      var i = 0;
      for (;18 > i;i++) {
        var d = !test && 1 == (1 & bits >> i);
        this.modules[Math.floor(i / 3)][i % 3 + this.moduleCount - 8 - 3] = d;
      }
      i = 0;
      for (;18 > i;i++) {
        d = !test && 1 == (1 & bits >> i);
        this.modules[i % 3 + this.moduleCount - 8 - 3][Math.floor(i / 3)] = d;
      }
    },
    setupTypeInfo : function(test, maskPattern) {
      var data = this.errorCorrectLevel << 3 | maskPattern;
      var bits = QRUtil.getBCHTypeInfo(data);
      var i = 0;
      for (;15 > i;i++) {
        var g = !test && 1 == (1 & bits >> i);
        if (6 > i) {
          this.modules[i][8] = g;
        } else {
          if (8 > i) {
            this.modules[i + 1][8] = g;
          } else {
            this.modules[this.moduleCount - 15 + i][8] = g;
          }
        }
      }
      i = 0;
      for (;15 > i;i++) {
        g = !test && 1 == (1 & bits >> i);
        if (8 > i) {
          this.modules[8][this.moduleCount - i - 1] = g;
        } else {
          if (9 > i) {
            this.modules[8][15 - i - 1 + 1] = g;
          } else {
            this.modules[8][15 - i - 1] = g;
          }
        }
      }
      this.modules[this.moduleCount - 8][8] = !test;
    },
    mapData : function(data, maskPattern) {
      var inc = -1;
      var row = this.moduleCount - 1;
      var bitIndex = 7;
      var byteIndex = 0;
      var col = this.moduleCount - 1;
      for (;col > 0;col -= 2) {
        if (6 == col) {
          col--;
        }
        for (;;) {
          var c = 0;
          for (;2 > c;c++) {
            if (null == this.modules[row][col - c]) {
              var perm = false;
              if (byteIndex < data.length) {
                perm = 1 == (1 & data[byteIndex] >>> bitIndex);
              }
              var mask = QRUtil.getMask(maskPattern, row, col - c);
              if (mask) {
                perm = !perm;
              }
              this.modules[row][col - c] = perm;
              bitIndex--;
              if (-1 == bitIndex) {
                byteIndex++;
                bitIndex = 7;
              }
            }
          }
          if (row += inc, 0 > row || this.moduleCount <= row) {
            row -= inc;
            inc = -inc;
            break;
          }
        }
      }
    }
  };
  QRCodeModel.PAD0 = 236;
  QRCodeModel.PAD1 = 17;
  QRCodeModel.createData = function(typeNumber, errorCorrectLevel, dataList) {
    var rsBlocks = QRRSBlock.getRSBlocks(typeNumber, errorCorrectLevel);
    var buffer = new QRBitBuffer;
    var i = 0;
    for (;i < dataList.length;i++) {
      var data = dataList[i];
      buffer.put(data.mode, 4);
      buffer.put(data.getLength(), QRUtil.getLengthInBits(data.mode, typeNumber));
      data.write(buffer);
    }
    var totalDataCount = 0;
    i = 0;
    for (;i < rsBlocks.length;i++) {
      totalDataCount += rsBlocks[i].dataCount;
    }
    if (buffer.getLengthInBits() > 8 * totalDataCount) {
      throw new Error("code length overflow. (" + buffer.getLengthInBits() + ">" + 8 * totalDataCount + ")");
    }
    if (buffer.getLengthInBits() + 4 <= 8 * totalDataCount) {
      buffer.put(0, 4);
    }
    for (;0 != buffer.getLengthInBits() % 8;) {
      buffer.putBit(false);
    }
    for (;;) {
      if (buffer.getLengthInBits() >= 8 * totalDataCount) {
        break;
      }
      if (buffer.put(QRCodeModel.PAD0, 8), buffer.getLengthInBits() >= 8 * totalDataCount) {
        break;
      }
      buffer.put(QRCodeModel.PAD1, 8);
    }
    return QRCodeModel.createBytes(buffer, rsBlocks);
  };
  QRCodeModel.createBytes = function(buffer, rsBlocks) {
    var offset = 0;
    var maxDcCount = 0;
    var maxEcCount = 0;
    var dcdata = new Array(rsBlocks.length);
    var ecdata = new Array(rsBlocks.length);
    var r = 0;
    for (;r < rsBlocks.length;r++) {
      var dcCount = rsBlocks[r].dataCount;
      var ecCount = rsBlocks[r].totalCount - dcCount;
      maxDcCount = Math.max(maxDcCount, dcCount);
      maxEcCount = Math.max(maxEcCount, ecCount);
      dcdata[r] = new Array(dcCount);
      var i = 0;
      for (;i < dcdata[r].length;i++) {
        dcdata[r][i] = 255 & buffer.buffer[i + offset];
      }
      offset += dcCount;
      var rsPoly = QRUtil.getErrorCorrectPolynomial(ecCount);
      var rawPoly = new QRPolynomial(dcdata[r], rsPoly.getLength() - 1);
      var modPoly = rawPoly.mod(rsPoly);
      ecdata[r] = new Array(rsPoly.getLength() - 1);
      i = 0;
      for (;i < ecdata[r].length;i++) {
        var modIndex = i + modPoly.getLength() - ecdata[r].length;
        ecdata[r][i] = modIndex >= 0 ? modPoly.get(modIndex) : 0;
      }
    }
    var totalCodeCount = 0;
    i = 0;
    for (;i < rsBlocks.length;i++) {
      totalCodeCount += rsBlocks[i].totalCount;
    }
    var data = new Array(totalCodeCount);
    var j = 0;
    i = 0;
    for (;maxDcCount > i;i++) {
      r = 0;
      for (;r < rsBlocks.length;r++) {
        if (i < dcdata[r].length) {
          data[j++] = dcdata[r][i];
        }
      }
    }
    i = 0;
    for (;maxEcCount > i;i++) {
      r = 0;
      for (;r < rsBlocks.length;r++) {
        if (i < ecdata[r].length) {
          data[j++] = ecdata[r][i];
        }
      }
    }
    return data;
  };
  var QRMode = {
    MODE_NUMBER : 1,
    MODE_ALPHA_NUM : 2,
    MODE_8BIT_BYTE : 4,
    MODE_KANJI : 8
  };
  var QRErrorCorrectLevel = {
    L : 1,
    M : 0,
    Q : 3,
    H : 2
  };
  var QRMaskPattern = {
    PATTERN000 : 0,
    PATTERN001 : 1,
    PATTERN010 : 2,
    PATTERN011 : 3,
    PATTERN100 : 4,
    PATTERN101 : 5,
    PATTERN110 : 6,
    PATTERN111 : 7
  };
  var QRUtil = {
    PATTERN_POSITION_TABLE : [[], [6, 18], [6, 22], [6, 26], [6, 30], [6, 34], [6, 22, 38], [6, 24, 42], [6, 26, 46], [6, 28, 50], [6, 30, 54], [6, 32, 58], [6, 34, 62], [6, 26, 46, 66], [6, 26, 48, 70], [6, 26, 50, 74], [6, 30, 54, 78], [6, 30, 56, 82], [6, 30, 58, 86], [6, 34, 62, 90], [6, 28, 50, 72, 94], [6, 26, 50, 74, 98], [6, 30, 54, 78, 102], [6, 28, 54, 80, 106], [6, 32, 58, 84, 110], [6, 30, 58, 86, 114], [6, 34, 62, 90, 118], [6, 26, 50, 74, 98, 122], [6, 30, 54, 78, 102, 126], [6, 26, 
    52, 78, 104, 130], [6, 30, 56, 82, 108, 134], [6, 34, 60, 86, 112, 138], [6, 30, 58, 86, 114, 142], [6, 34, 62, 90, 118, 146], [6, 30, 54, 78, 102, 126, 150], [6, 24, 50, 76, 102, 128, 154], [6, 28, 54, 80, 106, 132, 158], [6, 32, 58, 84, 110, 136, 162], [6, 26, 54, 82, 110, 138, 166], [6, 30, 58, 86, 114, 142, 170]],
    G15 : 1335,
    G18 : 7973,
    G15_MASK : 21522,
    getBCHTypeInfo : function(data) {
      var d = data << 10;
      for (;QRUtil.getBCHDigit(d) - QRUtil.getBCHDigit(QRUtil.G15) >= 0;) {
        d ^= QRUtil.G15 << QRUtil.getBCHDigit(d) - QRUtil.getBCHDigit(QRUtil.G15);
      }
      return(data << 10 | d) ^ QRUtil.G15_MASK;
    },
    getBCHTypeNumber : function(data) {
      var d = data << 12;
      for (;QRUtil.getBCHDigit(d) - QRUtil.getBCHDigit(QRUtil.G18) >= 0;) {
        d ^= QRUtil.G18 << QRUtil.getBCHDigit(d) - QRUtil.getBCHDigit(QRUtil.G18);
      }
      return data << 12 | d;
    },
    getBCHDigit : function(v23) {
      var digit = 0;
      for (;0 != v23;) {
        digit++;
        v23 >>>= 1;
      }
      return digit;
    },
    getPatternPosition : function(typeNumber) {
      return QRUtil.PATTERN_POSITION_TABLE[typeNumber - 1];
    },
    getMask : function(maskPattern, i, j) {
      switch(maskPattern) {
        case QRMaskPattern.PATTERN000:
          return 0 == (i + j) % 2;
        case QRMaskPattern.PATTERN001:
          return 0 == i % 2;
        case QRMaskPattern.PATTERN010:
          return 0 == j % 3;
        case QRMaskPattern.PATTERN011:
          return 0 == (i + j) % 3;
        case QRMaskPattern.PATTERN100:
          return 0 == (Math.floor(i / 2) + Math.floor(j / 3)) % 2;
        case QRMaskPattern.PATTERN101:
          return 0 == i * j % 2 + i * j % 3;
        case QRMaskPattern.PATTERN110:
          return 0 == (i * j % 2 + i * j % 3) % 2;
        case QRMaskPattern.PATTERN111:
          return 0 == (i * j % 3 + (i + j) % 2) % 2;
        default:
          throw new Error("bad maskPattern:" + maskPattern);;
      }
    },
    getErrorCorrectPolynomial : function(errorCorrectLength) {
      var a = new QRPolynomial([1], 0);
      var i = 0;
      for (;errorCorrectLength > i;i++) {
        a = a.multiply(new QRPolynomial([1, QRMath.gexp(i)], 0));
      }
      return a;
    },
    getLengthInBits : function(mode, type) {
      if (type >= 1 && 10 > type) {
        switch(mode) {
          case QRMode.MODE_NUMBER:
            return 10;
          case QRMode.MODE_ALPHA_NUM:
            return 9;
          case QRMode.MODE_8BIT_BYTE:
            return 8;
          case QRMode.MODE_KANJI:
            return 8;
          default:
            throw new Error("mode:" + mode);;
        }
      } else {
        if (27 > type) {
          switch(mode) {
            case QRMode.MODE_NUMBER:
              return 12;
            case QRMode.MODE_ALPHA_NUM:
              return 11;
            case QRMode.MODE_8BIT_BYTE:
              return 16;
            case QRMode.MODE_KANJI:
              return 10;
            default:
              throw new Error("mode:" + mode);;
          }
        } else {
          if (!(41 > type)) {
            throw new Error("type:" + type);
          }
          switch(mode) {
            case QRMode.MODE_NUMBER:
              return 14;
            case QRMode.MODE_ALPHA_NUM:
              return 13;
            case QRMode.MODE_8BIT_BYTE:
              return 16;
            case QRMode.MODE_KANJI:
              return 12;
            default:
              throw new Error("mode:" + mode);;
          }
        }
      }
    },
    getLostPoint : function(qrCode) {
      var r = qrCode.getModuleCount();
      var value = 0;
      var row = 0;
      for (;r > row;row++) {
        var col = 0;
        for (;r > col;col++) {
          var f = 0;
          var dark = qrCode.isDark(row, col);
          var rowOffset = -1;
          for (;1 >= rowOffset;rowOffset++) {
            if (!(0 > row + rowOffset || row + rowOffset >= r)) {
              var c = -1;
              for (;1 >= c;c++) {
                if (!(0 > col + c)) {
                  if (!(col + c >= r)) {
                    if (0 != rowOffset || 0 != c) {
                      if (dark == qrCode.isDark(row + rowOffset, col + c)) {
                        f++;
                      }
                    }
                  }
                }
              }
            }
          }
          if (f > 5) {
            value += 3 + f - 5;
          }
        }
      }
      row = 0;
      for (;r - 1 > row;row++) {
        col = 0;
        for (;r - 1 > col;col++) {
          var zeroQuoted = 0;
          if (qrCode.isDark(row, col)) {
            zeroQuoted++;
          }
          if (qrCode.isDark(row + 1, col)) {
            zeroQuoted++;
          }
          if (qrCode.isDark(row, col + 1)) {
            zeroQuoted++;
          }
          if (qrCode.isDark(row + 1, col + 1)) {
            zeroQuoted++;
          }
          if (0 == zeroQuoted || 4 == zeroQuoted) {
            value += 3;
          }
        }
      }
      row = 0;
      for (;r > row;row++) {
        col = 0;
        for (;r - 6 > col;col++) {
          if (qrCode.isDark(row, col)) {
            if (!qrCode.isDark(row, col + 1)) {
              if (qrCode.isDark(row, col + 2)) {
                if (qrCode.isDark(row, col + 3)) {
                  if (qrCode.isDark(row, col + 4)) {
                    if (!qrCode.isDark(row, col + 5)) {
                      if (qrCode.isDark(row, col + 6)) {
                        value += 40;
                      }
                    }
                  }
                }
              }
            }
          }
        }
      }
      col = 0;
      for (;r > col;col++) {
        row = 0;
        for (;r - 6 > row;row++) {
          if (qrCode.isDark(row, col)) {
            if (!qrCode.isDark(row + 1, col)) {
              if (qrCode.isDark(row + 2, col)) {
                if (qrCode.isDark(row + 3, col)) {
                  if (qrCode.isDark(row + 4, col)) {
                    if (!qrCode.isDark(row + 5, col)) {
                      if (qrCode.isDark(row + 6, col)) {
                        value += 40;
                      }
                    }
                  }
                }
              }
            }
          }
        }
      }
      var d = 0;
      col = 0;
      for (;r > col;col++) {
        row = 0;
        for (;r > row;row++) {
          if (qrCode.isDark(row, col)) {
            d++;
          }
        }
      }
      var base = Math.abs(100 * d / r / r - 50) / 5;
      return value += 10 * base;
    }
  };
  var QRMath = {
    glog : function(n) {
      if (1 > n) {
        throw new Error("glog(" + n + ")");
      }
      return QRMath.LOG_TABLE[n];
    },
    gexp : function(n) {
      for (;0 > n;) {
        n += 255;
      }
      for (;n >= 256;) {
        n -= 255;
      }
      return QRMath.EXP_TABLE[n];
    },
    EXP_TABLE : new Array(256),
    LOG_TABLE : new Array(256)
  };
  var i = 0;
  for (;8 > i;i++) {
    QRMath.EXP_TABLE[i] = 1 << i;
  }
  i = 8;
  for (;256 > i;i++) {
    QRMath.EXP_TABLE[i] = QRMath.EXP_TABLE[i - 4] ^ QRMath.EXP_TABLE[i - 5] ^ QRMath.EXP_TABLE[i - 6] ^ QRMath.EXP_TABLE[i - 8];
  }
  i = 0;
  for (;255 > i;i++) {
    QRMath.LOG_TABLE[QRMath.EXP_TABLE[i]] = i;
  }
  QRPolynomial.prototype = {
    get : function(index) {
      return this.num[index];
    },
    getLength : function() {
      return this.num.length;
    },
    multiply : function(e) {
      var num = new Array(this.getLength() + e.getLength() - 1);
      var i = 0;
      for (;i < this.getLength();i++) {
        var j = 0;
        for (;j < e.getLength();j++) {
          num[i + j] ^= QRMath.gexp(QRMath.glog(this.get(i)) + QRMath.glog(e.get(j)));
        }
      }
      return new QRPolynomial(num, 0);
    },
    mod : function(e) {
      if (this.getLength() - e.getLength() < 0) {
        return this;
      }
      var ratio = QRMath.glog(this.get(0)) - QRMath.glog(e.get(0));
      var num = new Array(this.getLength());
      var i = 0;
      for (;i < this.getLength();i++) {
        num[i] = this.get(i);
      }
      i = 0;
      for (;i < e.getLength();i++) {
        num[i] ^= QRMath.gexp(QRMath.glog(e.get(i)) + ratio);
      }
      return(new QRPolynomial(num, 0)).mod(e);
    }
  };
  QRRSBlock.RS_BLOCK_TABLE = [[1, 26, 19], [1, 26, 16], [1, 26, 13], [1, 26, 9], [1, 44, 34], [1, 44, 28], [1, 44, 22], [1, 44, 16], [1, 70, 55], [1, 70, 44], [2, 35, 17], [2, 35, 13], [1, 100, 80], [2, 50, 32], [2, 50, 24], [4, 25, 9], [1, 134, 108], [2, 67, 43], [2, 33, 15, 2, 34, 16], [2, 33, 11, 2, 34, 12], [2, 86, 68], [4, 43, 27], [4, 43, 19], [4, 43, 15], [2, 98, 78], [4, 49, 31], [2, 32, 14, 4, 33, 15], [4, 39, 13, 1, 40, 14], [2, 121, 97], [2, 60, 38, 2, 61, 39], [4, 40, 18, 2, 41, 19], 
  [4, 40, 14, 2, 41, 15], [2, 146, 116], [3, 58, 36, 2, 59, 37], [4, 36, 16, 4, 37, 17], [4, 36, 12, 4, 37, 13], [2, 86, 68, 2, 87, 69], [4, 69, 43, 1, 70, 44], [6, 43, 19, 2, 44, 20], [6, 43, 15, 2, 44, 16], [4, 101, 81], [1, 80, 50, 4, 81, 51], [4, 50, 22, 4, 51, 23], [3, 36, 12, 8, 37, 13], [2, 116, 92, 2, 117, 93], [6, 58, 36, 2, 59, 37], [4, 46, 20, 6, 47, 21], [7, 42, 14, 4, 43, 15], [4, 133, 107], [8, 59, 37, 1, 60, 38], [8, 44, 20, 4, 45, 21], [12, 33, 11, 4, 34, 12], [3, 145, 115, 1, 146, 
  116], [4, 64, 40, 5, 65, 41], [11, 36, 16, 5, 37, 17], [11, 36, 12, 5, 37, 13], [5, 109, 87, 1, 110, 88], [5, 65, 41, 5, 66, 42], [5, 54, 24, 7, 55, 25], [11, 36, 12], [5, 122, 98, 1, 123, 99], [7, 73, 45, 3, 74, 46], [15, 43, 19, 2, 44, 20], [3, 45, 15, 13, 46, 16], [1, 135, 107, 5, 136, 108], [10, 74, 46, 1, 75, 47], [1, 50, 22, 15, 51, 23], [2, 42, 14, 17, 43, 15], [5, 150, 120, 1, 151, 121], [9, 69, 43, 4, 70, 44], [17, 50, 22, 1, 51, 23], [2, 42, 14, 19, 43, 15], [3, 141, 113, 4, 142, 114], 
  [3, 70, 44, 11, 71, 45], [17, 47, 21, 4, 48, 22], [9, 39, 13, 16, 40, 14], [3, 135, 107, 5, 136, 108], [3, 67, 41, 13, 68, 42], [15, 54, 24, 5, 55, 25], [15, 43, 15, 10, 44, 16], [4, 144, 116, 4, 145, 117], [17, 68, 42], [17, 50, 22, 6, 51, 23], [19, 46, 16, 6, 47, 17], [2, 139, 111, 7, 140, 112], [17, 74, 46], [7, 54, 24, 16, 55, 25], [34, 37, 13], [4, 151, 121, 5, 152, 122], [4, 75, 47, 14, 76, 48], [11, 54, 24, 14, 55, 25], [16, 45, 15, 14, 46, 16], [6, 147, 117, 4, 148, 118], [6, 73, 45, 14, 
  74, 46], [11, 54, 24, 16, 55, 25], [30, 46, 16, 2, 47, 17], [8, 132, 106, 4, 133, 107], [8, 75, 47, 13, 76, 48], [7, 54, 24, 22, 55, 25], [22, 45, 15, 13, 46, 16], [10, 142, 114, 2, 143, 115], [19, 74, 46, 4, 75, 47], [28, 50, 22, 6, 51, 23], [33, 46, 16, 4, 47, 17], [8, 152, 122, 4, 153, 123], [22, 73, 45, 3, 74, 46], [8, 53, 23, 26, 54, 24], [12, 45, 15, 28, 46, 16], [3, 147, 117, 10, 148, 118], [3, 73, 45, 23, 74, 46], [4, 54, 24, 31, 55, 25], [11, 45, 15, 31, 46, 16], [7, 146, 116, 7, 147, 
  117], [21, 73, 45, 7, 74, 46], [1, 53, 23, 37, 54, 24], [19, 45, 15, 26, 46, 16], [5, 145, 115, 10, 146, 116], [19, 75, 47, 10, 76, 48], [15, 54, 24, 25, 55, 25], [23, 45, 15, 25, 46, 16], [13, 145, 115, 3, 146, 116], [2, 74, 46, 29, 75, 47], [42, 54, 24, 1, 55, 25], [23, 45, 15, 28, 46, 16], [17, 145, 115], [10, 74, 46, 23, 75, 47], [10, 54, 24, 35, 55, 25], [19, 45, 15, 35, 46, 16], [17, 145, 115, 1, 146, 116], [14, 74, 46, 21, 75, 47], [29, 54, 24, 19, 55, 25], [11, 45, 15, 46, 46, 16], [13, 
  145, 115, 6, 146, 116], [14, 74, 46, 23, 75, 47], [44, 54, 24, 7, 55, 25], [59, 46, 16, 1, 47, 17], [12, 151, 121, 7, 152, 122], [12, 75, 47, 26, 76, 48], [39, 54, 24, 14, 55, 25], [22, 45, 15, 41, 46, 16], [6, 151, 121, 14, 152, 122], [6, 75, 47, 34, 76, 48], [46, 54, 24, 10, 55, 25], [2, 45, 15, 64, 46, 16], [17, 152, 122, 4, 153, 123], [29, 74, 46, 14, 75, 47], [49, 54, 24, 10, 55, 25], [24, 45, 15, 46, 46, 16], [4, 152, 122, 18, 153, 123], [13, 74, 46, 32, 75, 47], [48, 54, 24, 14, 55, 25], 
  [42, 45, 15, 32, 46, 16], [20, 147, 117, 4, 148, 118], [40, 75, 47, 7, 76, 48], [43, 54, 24, 22, 55, 25], [10, 45, 15, 67, 46, 16], [19, 148, 118, 6, 149, 119], [18, 75, 47, 31, 76, 48], [34, 54, 24, 34, 55, 25], [20, 45, 15, 61, 46, 16]];
  QRRSBlock.getRSBlocks = function(typeNumber, errorCorrectLevel) {
    var rsBlock = QRRSBlock.getRsBlockTable(typeNumber, errorCorrectLevel);
    if (void 0 == rsBlock) {
      throw new Error("bad rs block @ typeNumber:" + typeNumber + "/errorCorrectLevel:" + errorCorrectLevel);
    }
    var a = rsBlock.length / 3;
    var list = [];
    var b = 0;
    for (;a > b;b++) {
      var count = rsBlock[3 * b + 0];
      var totalCount = rsBlock[3 * b + 1];
      var dataCount = rsBlock[3 * b + 2];
      var baseValue = 0;
      for (;count > baseValue;baseValue++) {
        list.push(new QRRSBlock(totalCount, dataCount));
      }
    }
    return list;
  };
  QRRSBlock.getRsBlockTable = function(typeNumber, errorCorrectLevel) {
    switch(errorCorrectLevel) {
      case QRErrorCorrectLevel.L:
        return QRRSBlock.RS_BLOCK_TABLE[4 * (typeNumber - 1) + 0];
      case QRErrorCorrectLevel.M:
        return QRRSBlock.RS_BLOCK_TABLE[4 * (typeNumber - 1) + 1];
      case QRErrorCorrectLevel.Q:
        return QRRSBlock.RS_BLOCK_TABLE[4 * (typeNumber - 1) + 2];
      case QRErrorCorrectLevel.H:
        return QRRSBlock.RS_BLOCK_TABLE[4 * (typeNumber - 1) + 3];
      default:
        return void 0;
    }
  };
  QRBitBuffer.prototype = {
    get : function(index) {
      var bufIndex = Math.floor(index / 8);
      return 1 == (1 & this.buffer[bufIndex] >>> 7 - index % 8);
    },
    put : function(url, opt_attributes) {
      var b = 0;
      for (;opt_attributes > b;b++) {
        this.putBit(1 == (1 & url >>> opt_attributes - b - 1));
      }
    },
    getLengthInBits : function() {
      return this.length;
    },
    putBit : function(recurring) {
      var bufIndex = Math.floor(this.length / 8);
      if (this.buffer.length <= bufIndex) {
        this.buffer.push(0);
      }
      if (recurring) {
        this.buffer[bufIndex] |= 128 >>> this.length % 8;
      }
      this.length++;
    }
  };
  var codeSegments = [[17, 14, 11, 7], [32, 26, 20, 14], [53, 42, 32, 24], [78, 62, 46, 34], [106, 84, 60, 44], [134, 106, 74, 58], [154, 122, 86, 64], [192, 152, 108, 84], [230, 180, 130, 98], [271, 213, 151, 119], [321, 251, 177, 137], [367, 287, 203, 155], [425, 331, 241, 177], [458, 362, 258, 194], [520, 412, 292, 220], [586, 450, 322, 250], [644, 504, 364, 280], [718, 560, 394, 310], [792, 624, 442, 338], [858, 666, 482, 382], [929, 711, 509, 403], [1003, 779, 565, 439], [1091, 857, 611, 461], 
  [1171, 911, 661, 511], [1273, 997, 715, 535], [1367, 1059, 751, 593], [1465, 1125, 805, 625], [1528, 1190, 868, 658], [1628, 1264, 908, 698], [1732, 1370, 982, 742], [1840, 1452, 1030, 790], [1952, 1538, 1112, 842], [2068, 1628, 1168, 898], [2188, 1722, 1228, 958], [2303, 1809, 1283, 983], [2431, 1911, 1351, 1051], [2563, 1989, 1423, 1093], [2699, 2099, 1499, 1139], [2809, 2213, 1579, 1219], [2953, 2331, 1663, 1273]];
  var svgDrawer = function() {
    var Drawing = function(el, htOption) {
      this._el = el;
      this._htOption = htOption;
    };
    return Drawing.prototype.draw = function(oQRCode) {
      function makeSVG(tag, attrs) {
        var el = document.createElementNS("http://www.w3.org/2000/svg", tag);
        var attr;
        for (attr in attrs) {
          if (attrs.hasOwnProperty(attr)) {
            el.setAttribute(attr, attrs[attr]);
          }
        }
        return el;
      }
      var _htOption = this._htOption;
      var _el = this._el;
      var nCount = oQRCode.getModuleCount();
      Math.floor(_htOption.width / nCount);
      Math.floor(_htOption.height / nCount);
      this.clear();
      var svg = makeSVG("svg", {
        viewBox : "0 0 " + String(nCount) + " " + String(nCount),
        width : "100%",
        height : "100%",
        fill : _htOption.colorLight
      });
      svg.setAttributeNS("http://www.w3.org/2000/xmlns/", "xmlns:xlink", "http://www.w3.org/1999/xlink");
      _el.appendChild(svg);
      svg.appendChild(makeSVG("rect", {
        fill : _htOption.colorDark,
        width : "1",
        height : "1",
        id : "template"
      }));
      var row = 0;
      for (;nCount > row;row++) {
        var col = 0;
        for (;nCount > col;col++) {
          if (oQRCode.isDark(row, col)) {
            var child = makeSVG("use", {
              x : String(row),
              y : String(col)
            });
            child.setAttributeNS("http://www.w3.org/1999/xlink", "href", "#template");
            svg.appendChild(child);
          }
        }
      }
    }, Drawing.prototype.clear = function() {
      for (;this._el.hasChildNodes();) {
        this._el.removeChild(this._el.lastChild);
      }
    }, Drawing;
  }();
  var useSVG = "svg" === document.documentElement.tagName.toLowerCase();
  var Drawing = useSVG ? svgDrawer : hasOwnProp() ? function() {
    function _onMakeImage() {
      this._elImage.src = this._elCanvas.toDataURL("image/png");
      this._elImage.style.display = "block";
      this._elCanvas.style.display = "none";
    }
    function _safeSetDataURI(fSuccess, fFail) {
      var self = this;
      if (self._fFail = fFail, self._fSuccess = fSuccess, null === self._bSupportDataURI) {
        var el = document.createElement("img");
        var fOnError = function() {
          self._bSupportDataURI = false;
          if (self._fFail) {
            _fFail.call(self);
          }
        };
        var fOnSuccess = function() {
          self._bSupportDataURI = true;
          if (self._fSuccess) {
            self._fSuccess.call(self);
          }
        };
        return el.onabort = fOnError, el.onerror = fOnError, el.onload = fOnSuccess, el.src = "data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAUAAAAFCAYAAACNbyblAAAAHElEQVQI12P4//8/w38GIAXDIBKE0DHxgljNBAAO9TXL0Y4OHwAAAABJRU5ErkJggg==", void 0;
      }
      if (self._bSupportDataURI === true && self._fSuccess) {
        self._fSuccess.call(self);
      } else {
        if (self._bSupportDataURI === false) {
          if (self._fFail) {
            self._fFail.call(self);
          }
        }
      }
    }
    if (this._android && this._android <= 2.1) {
      var factor = 1 / window.devicePixelRatio;
      var matcherFunction = CanvasRenderingContext2D.prototype.drawImage;
      CanvasRenderingContext2D.prototype.drawImage = function(image, width, y, src, dst_x, opt_group, arg2, e) {
        if ("nodeName" in image && /img/i.test(image.nodeName)) {
          var i = arguments.length - 1;
          for (;i >= 1;i--) {
            arguments[i] = arguments[i] * factor;
          }
        } else {
          if ("undefined" == typeof e) {
            arguments[1] *= factor;
            arguments[2] *= factor;
            arguments[3] *= factor;
            arguments[4] *= factor;
          }
        }
        matcherFunction.apply(this, arguments);
      };
    }
    var Drawing = function(el, htOption) {
      this._bIsPainted = false;
      this._android = _getAndroid();
      this._htOption = htOption;
      this._elCanvas = document.createElement("canvas");
      this._elCanvas.width = htOption.width;
      this._elCanvas.height = htOption.height;
      el.appendChild(this._elCanvas);
      this._el = el;
      this._oContext = this._elCanvas.getContext("2d");
      this._bIsPainted = false;
      this._elImage = document.createElement("img");
      this._elImage.style.display = "none";
      this._el.appendChild(this._elImage);
      this._bSupportDataURI = null;
    };
    return Drawing.prototype.draw = function(oQRCode) {
      var _elImage = this._elImage;
      var _oContext = this._oContext;
      var _htOption = this._htOption;
      var nCount = oQRCode.getModuleCount();
      var nWidth = _htOption.width / nCount;
      var nHeight = _htOption.height / nCount;
      var nRoundedWidth = Math.round(nWidth);
      var nRoundedHeight = Math.round(nHeight);
      _elImage.style.display = "none";
      this.clear();
      var row = 0;
      for (;nCount > row;row++) {
        var col = 0;
        for (;nCount > col;col++) {
          var bIsDark = oQRCode.isDark(row, col);
          var nLeft = col * nWidth;
          var nTop = row * nHeight;
          _oContext.strokeStyle = bIsDark ? _htOption.colorDark : _htOption.colorLight;
          _oContext.lineWidth = 1;
          _oContext.fillStyle = bIsDark ? _htOption.colorDark : _htOption.colorLight;
          _oContext.fillRect(nLeft, nTop, nWidth, nHeight);
          _oContext.strokeRect(Math.floor(nLeft) + 0.5, Math.floor(nTop) + 0.5, nRoundedWidth, nRoundedHeight);
          _oContext.strokeRect(Math.ceil(nLeft) - 0.5, Math.ceil(nTop) - 0.5, nRoundedWidth, nRoundedHeight);
        }
      }
      this._bIsPainted = true;
    }, Drawing.prototype.makeImage = function() {
      if (this._bIsPainted) {
        _safeSetDataURI.call(this, _onMakeImage);
      }
    }, Drawing.prototype.isPainted = function() {
      return this._bIsPainted;
    }, Drawing.prototype.clear = function() {
      this._oContext.clearRect(0, 0, this._elCanvas.width, this._elCanvas.height);
      this._bIsPainted = false;
    }, Drawing.prototype.round = function(x) {
      return x ? Math.floor(1E3 * x) / 1E3 : x;
    }, Drawing;
  }() : function() {
    var Drawing = function(el, htOption) {
      this._el = el;
      this._htOption = htOption;
    };
    return Drawing.prototype.draw = function(oQRCode) {
      var _htOption = this._htOption;
      var _el = this._el;
      var nCount = oQRCode.getModuleCount();
      var e = Math.floor(_htOption.width / nCount);
      var f = Math.floor(_htOption.height / nCount);
      var tagNameArr = ['<table style="border:0;border-collapse:collapse;">'];
      var row = 0;
      for (;nCount > row;row++) {
        tagNameArr.push("<tr>");
        var col = 0;
        for (;nCount > col;col++) {
          tagNameArr.push('<td style="border:0;border-collapse:collapse;padding:0;margin:0;width:' + e + "px;height:" + f + "px;background-color:" + (oQRCode.isDark(row, col) ? _htOption.colorDark : _htOption.colorLight) + ';"></td>');
        }
        tagNameArr.push("</tr>");
      }
      tagNameArr.push("</table>");
      _el.innerHTML = tagNameArr.join("");
      var elTable = _el.childNodes[0];
      var y = (_htOption.width - elTable.offsetWidth) / 2;
      var x = (_htOption.height - elTable.offsetHeight) / 2;
      if (y > 0) {
        if (x > 0) {
          elTable.style.margin = x + "px " + y + "px";
        }
      }
    }, Drawing.prototype.clear = function() {
      this._el.innerHTML = "";
    }, Drawing;
  }();
  QRCode = function(el, vOption) {
    if (this._htOption = {
      width : 256,
      height : 256,
      typeNumber : 4,
      colorDark : "#000000",
      colorLight : "#ffffff",
      correctLevel : QRErrorCorrectLevel.H
    }, "string" == typeof vOption && (vOption = {
      text : vOption
    }), vOption) {
      var i;
      for (i in vOption) {
        this._htOption[i] = vOption[i];
      }
    }
    if ("string" == typeof el) {
      el = document.getElementById(el);
    }
    this._android = _getAndroid();
    this._el = el;
    this._oQRCode = null;
    this._oDrawing = new Drawing(this._el, this._htOption);
    if (this._htOption.text) {
      this.makeCode(this._htOption.text);
    }
  };
  QRCode.prototype.makeCode = function(sText) {
    this._oQRCode = new QRCodeModel(_getTypeNumber(sText, this._htOption.correctLevel), this._htOption.correctLevel);
    this._oQRCode.addData(sText);
    this._oQRCode.make();
    this._el.title = sText;
    this._oDrawing.draw(this._oQRCode);
    this.makeImage();
  };
  QRCode.prototype.makeImage = function() {
    if ("function" == typeof this._oDrawing.makeImage) {
      if (!this._android || this._android >= 3) {
        this._oDrawing.makeImage();
      }
    }
  };
  QRCode.prototype.clear = function() {
    this._oDrawing.clear();
  };
  QRCode.CorrectLevel = QRErrorCorrectLevel;
}();
